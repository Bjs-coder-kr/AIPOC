# scripts/generate_sample_pdfs.py
# pip install fpdf

from __future__ import annotations

import zipfile
from pathlib import Path

from fpdf import FPDF

DEFAULT_FONT = r"C:\Windows\Fonts\malgun.ttf"


class PDF(FPDF):
    def footer(self):
        self.set_y(-15)
        self.set_font("KFONT", size=8)
        self.cell(0, 10, f"Page {self.page_no()}", align="C")


def create_pdf(out_path: Path, title: str, content_lines: list[str], font_path: str):
    pdf = PDF(format="A4", unit="mm")
    pdf.set_margins(15, 15, 15)
    pdf.set_auto_page_break(auto=True, margin=15)

    # fpdf2 2.8.5: uni 파라미터 제거(경고 제거). TTF면 유니코드 처리 가능.
    pdf.add_font("KFONT", "", font_path)
    pdf.add_page()

    # effective page width (w=0 쓰면 X 꼬일 때 폭=0으로 터짐)
    epw = pdf.w - pdf.l_margin - pdf.r_margin

    # Title (cell 대신 multi_cell로 단순화)
    pdf.set_font("KFONT", size=16)
    pdf.set_x(pdf.l_margin)
    pdf.multi_cell(epw, 10, title, align="C")
    pdf.ln(3)

    pdf.set_font("KFONT", size=11)

    for line in content_lines:
        # 매 줄 시작 전에 X 강제 리셋 (이게 핵심)
        pdf.set_x(pdf.l_margin)

        if not line:
            pdf.ln(3)
            continue

        # 구분선 처리
        if "---" in line:
            pdf.ln(1)
            y = pdf.get_y()
            pdf.line(pdf.l_margin, y, pdf.w - pdf.r_margin, y)
            pdf.ln(3)
            continue

        # 소제목
        if line.startswith(("■", "▶", "[")):
            pdf.ln(2)
            pdf.set_font("KFONT", size=12)
            pdf.set_x(pdf.l_margin)
            pdf.multi_cell(epw, 7, line)
            pdf.set_font("KFONT", size=11)
            continue

        # 일반 텍스트
        pdf.set_x(pdf.l_margin)
        pdf.multi_cell(epw, 6, line)

    pdf.output(str(out_path))


def main():
    out_dir = Path("sample_pdfs")
    out_dir.mkdir(parents=True, exist_ok=True)

    font_path = DEFAULT_FONT
    if not Path(font_path).exists():
        print(f"[Error] 폰트 파일을 찾을 수 없습니다: {font_path}")
        print("DEFAULT_FONT를 시스템 한글 폰트 경로로 수정하세요.")
        return

    documents = [
        {
            "filename": "1_자기소개서_보수적(대기업형).pdf",
            "title": "자 기 소 개 서",
            "content": [
                "■ 성장과정",
                "'기본에 충실하자'는 가훈 아래, 책임감을 최우선으로 여기며 성장했습니다. 학창 시절 3년간 학급 임원을 도맡으며 작은 약속이라도 반드시 지키는 성실함을 몸에 익혔고, 이는 조직 생활에서 신뢰를 형성하는 밑거름이 되었습니다.",
                "",
                "■ 성격의 장단점",
                "저의 가장 큰 장점은 꼼꼼함입니다. 자료 분석 시 수치의 오차를 놓치지 않는 세밀함으로 팀 프로젝트에서 실수를 미연에 방지한 경험이 다수 있습니다. 반면 지나친 신중함이 속도를 늦출 때가 있어, 중요도에 따라 우선순위를 정해 마감 기한을 엄수하는 훈련을 하고 있습니다.",
                "",
                "■ 지원동기 및 포부",
                "귀사의 혁신적인 도전 정신에 깊이 공감하여 지원하게 되었습니다. 입사 후에는 저의 꼼꼼한 분석력을 바탕으로 업무 프로세스를 개선하고, 팀원들과 적극적으로 소통하여 조직의 성과 달성에 기여하는 인재가 되겠습니다.",
            ],
        },
        {
            "filename": "2_자기소개서_개방적(스타트업형).pdf",
            "title": "Portfolio & Career Description",
            "content": [
                "■ Core Competency (핵심 역량)",
                "* 데이터 분석: Python 및 SQL을 활용한 고객 이탈률 분석 및 인사이트 도출 가능",
                "* 커뮤니케이션: 유관 부서와의 협업을 이끄는 논리적인 설득력 보유",
                "* 문제 해결: 기존 프로세스의 비효율을 발견하고 자동화 툴을 도입해 업무 시간 30% 단축",
                "",
                "■ Key Projects (주요 프로젝트 경험)",
                "1. OOO 마케팅 최적화 프로젝트 (2023.01 ~ 2023.06)",
                "- 역할: 프로젝트 매니저(PM)",
                "- 내용: 타겟 고객층 재설정을 통한 광고 효율 개선",
                "- 성과: 전 분기 대비 전환율(CVR) 15% 상승 달성",
                "",
                "■ 지원 동기",
                "귀사가 추구하는 '사용자 중심의 서비스 혁신'은 제가 지향하는 커리어 방향성과 일치합니다. 주도적으로 문제를 정의하고 해결해 온 저의 경험이 귀사의 서비스 고도화에 즉각적인 기여를 할 수 있다고 확신합니다.",
            ],
        },
        {
            "filename": "3_개인정보_수집_이용_동의서.pdf",
            "title": "개인정보 수집 및 이용 동의서",
            "content": [
                "본 기관은 귀하의 개인정보를 중요시하며, 「개인정보 보호법」에 의거하여 아래와 같이 개인정보를 수집 및 이용하고자 합니다. 내용을 자세히 읽으신 후 동의 여부를 결정하여 주십시오.",
                "",
                "--------------------------------------------------",
                "[수집 및 이용 목적]",
                "서비스 가입 상담, 본인 확인, 안내 메시지 발송",
                "",
                "[수집 항목]",
                "성명, 연락처(휴대전화), 이메일 주소, 생년월일",
                "",
                "[보유 및 이용 기간]",
                "수집일로부터 1년 (또는 목적 달성 시 즉시 파기)",
                "--------------------------------------------------",
                "",
                "■ 동의 거부 권리 및 불이익",
                "귀하는 위 개인정보 수집 및 이용에 거부할 권리가 있습니다. 단, 동의를 거부할 경우 서비스 상담 및 가입 절차가 제한될 수 있습니다.",
                "",
                "위와 같이 개인정보를 수집·이용하는 것에 동의하십니까?",
                "□ 동의함        □ 동의하지 않음",
                "",
                "2024년    월    일",
                "성명 :                       (서명 또는 인)",
            ],
        },
        {
            "filename": "4_서비스_이용약관.pdf",
            "title": "OOO 서비스 이용 약관",
            "content": [
                "제1조 (목적)",
                "본 약관은 주식회사 OOO(이하 '회사')가 제공하는 제반 서비스의 이용과 관련하여 회사와 회원의 권리, 의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다.",
                "",
                "제2조 (용어의 정의)",
                "1. '회원'이라 함은 회사의 서비스에 접속하여 본 약관에 따라 회사와 이용계약을 체결하고 회사가 제공하는 서비스를 이용하는 고객을 말합니다.",
                "2. '아이디(ID)'라 함은 회원의 식별과 서비스 이용을 위하여 회원이 정하고 회사가 승인하는 문자와 숫자의 조합을 의미합니다.",
                "",
                "제3조 (약관의 게시와 개정)",
                "회사는 본 약관의 내용을 회원이 쉽게 알 수 있도록 서비스 초기 화면에 게시합니다. 회사는 법률에 위배되지 않는 범위 내에서 본 약관을 개정할 수 있습니다.",
                "",
                "제4조 (서비스의 제공)",
                "회사는 회원에게 아래와 같은 서비스를 제공합니다.",
                "1. 검색 서비스",
                "2. 게시판형 서비스",
                "3. 기타 회사가 추가 개발하거나 제휴를 통해 제공하는 일체의 서비스",
                "",
                "(이하 생략)",
            ],
        },
        {
            "filename": "5_고객만족도_설문조사.pdf",
            "title": "고객 만족도 설문조사",
            "content": [
                "저희 서비스를 이용해 주셔서 감사합니다. 더 나은 서비스를 제공하기 위해 귀하의 소중한 의견을 들려주세요.",
                "",
                "1. 오늘 제공받으신 서비스에 전반적으로 만족하십니까?",
                "□ 매우 만족   □ 만족   □ 보통   □ 불만족   □ 매우 불만족",
                "",
                "2. 직원의 응대는 친절하였습니까?",
                "□ 매우 친절함   □ 친절함   □ 보통   □ 불친절함   □ 매우 불친절함",
                "",
                "3. 서비스를 이용하며 가장 좋았던 점은 무엇입니까? (중복 선택 가능)",
                "□ 신속한 처리   □ 정확한 안내   □ 쾌적한 환경   □ 기타 (          )",
                "",
                "4. 개선이 필요하다고 느끼신 점이나 기타 건의사항을 자유롭게 적어주세요.",
                "",
                "--------------------------------------------------",
                "(                                                )",
                "(                                                )",
                "--------------------------------------------------",
            ],
        },
        {
            "filename": "6_안전점검표_체크리스트.pdf",
            "title": "사무실 일일 안전 점검표",
            "content": [
                "■ 점검 일자: 2024년    월    일",
                "■ 점검자:                   (인)",
                "",
                "--------------------------------------------------",
                "[전기 안전]",
                "1. 퇴근 전 불필요한 전원 플러그를 뽑았는가?   ( O / X )",
                "2. 문어발식 콘센트 사용 여부를 확인했는가?    ( O / X )",
                "",
                "[소방 안전]",
                "3. 소화기는 지정된 위치에 비치되어 있는가?    ( O / X )",
                "4. 비상구 통로에 적재물이 쌓여있지 않은가?    ( O / X )",
                "",
                "[보안 점검]",
                "5. 창문 및 출입문 시건장치는 확실한가?        ( O / X )",
                "6. 중요 문서가 책상 위에 방치되지 않았는가?   ( O / X )",
                "--------------------------------------------------",
                "",
                "■ 특이사항",
                "(                                                )",
            ],
        },
        {
            "filename": "7_복합형A_세미나신청서.pdf",
            "title": "2024년 하반기 직무 역량 강화 세미나 신청서",
            "content": [
                "1. 신청자 정보",
                "* 성 명: ",
                "* 소 속: ",
                "* 직 위: ",
                "* 연락처: ",
                "",
                "2. 사전 설문 조사",
                "Q1. 이번 세미나에서 가장 관심 있는 주제는 무엇입니까?",
                "□ 트렌드 분석   □ 실무 엑셀 스킬   □ 리더십 코칭   □ 기타",
                "",
                "Q2. 점심 식사 메뉴 선호도를 선택해 주세요.",
                "□ 한식 (도시락)   □ 양식 (샌드위치)   □ 식사 안 함",
                "",
                "3. 개인정보 활용 동의",
                "본 행사의 원활한 진행을 위해 연락처 정보를 수집하는 것에 동의합니다.",
                "( □ 예  /  □ 아니오 )",
                "",
                "2024.    .    .   신청인:              (인)",
            ],
        },
        {
            "filename": "8_복합형B_채용기초조사서.pdf",
            "title": "입사 지원 및 근무 가능 확인서",
            "content": [
                "■ 기본 인적 사항",
                "--------------------------------------------------",
                "성    명 : ",
                "생년월일 : ",
                "주    소 : ",
                "연 락 처 : ",
                "최종학력 : ",
                "보유자격 : ",
                "--------------------------------------------------",
                "",
                "■ 근무 조건 확인 (체크리스트)",
                "다음 항목을 읽고 가능한 경우에만 체크(V) 해주시기 바랍니다.",
                "",
                "1. 주말 및 공휴일 포함 주 5일 근무가 가능합니까? [   ]",
                "2. 6개월 이상 장기 근무가 가능합니까?            [   ]",
                "3. 무거운 짐(10kg)을 운반하는 데 무리가 없습니까?[   ]",
                "4. 인근 지점으로 파견 근무가 발생할 경우 동의합니까? [   ]",
                "",
                "■ 경력 기술 (간략히)",
                "(관련 업무 경험이 있다면 기간과 내용을 간략히 적어주세요)",
                "",
                "--------------------------------------------------",
                "",
                "",
                "--------------------------------------------------",
            ],
        },
    ]

    created: list[Path] = []
    print("PDF 생성을 시작합니다...")
    for doc in documents:
        out_path = out_dir / doc["filename"]
        try:
            create_pdf(out_path, doc["title"], doc["content"], font_path)
            created.append(out_path)
            print(f" - 생성 완료: {doc['filename']}")
        except Exception as e:
            print(f" - 실패: {doc['filename']} (Error: {e})")

    if created:
        zip_path = Path("Korean_Business_Documents.zip")
        with zipfile.ZipFile(zip_path, "w") as z:
            for p in created:
                z.write(p, arcname=p.name)

        print("=" * 50)
        print(f"저장 폴더: {out_dir.absolute()}")
        print(f"압축 파일: {zip_path.absolute()}")
        print("=" * 50)


if __name__ == "__main__":
    main()
